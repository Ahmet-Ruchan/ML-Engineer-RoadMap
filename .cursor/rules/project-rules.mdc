---
alwaysApply: true


# ğŸ§  **ML Engineer Roadmap â€” Project Rules**

> Interactive, bilingual (EN/TR) learning platform for AI/ML engineers.
> Built with Next.js + Supabase + Prisma + Tailwind + TypeScript.
> Hosted on Vercel + Supabase.

---

## ğŸ—ï¸ 1. GENERAL STRUCTURE

```
ml-roadmap/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ web/                â†’ Frontend + API (Next.js)
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ db/                 â†’ Prisma schema + DB client
â”‚   â”œâ”€â”€ ui/                 â†’ Shared UI components
â”‚   â””â”€â”€ config/             â†’ ESLint, Tailwind, TSConfig presets
â”œâ”€â”€ .env                    â†’ Supabase credentials
â”œâ”€â”€ turbo.json              â†’ Monorepo build config
â”œâ”€â”€ package.json            â†’ Root dependencies
â””â”€â”€ project-rules.md        â†’ This file (permanent context)
```

---

## ğŸ§© 2. TECHNOLOGY STACK

| Layer      | Technology                  | Purpose                 |
| ---------- | --------------------------- | ----------------------- |
| Frontend   | **Next.js (App Router)**    | UI + API routes         |
| Language   | **TypeScript**              | Type safety             |
| Styling    | **TailwindCSS + shadcn/ui** | Design system           |
| ORM        | **Prisma**                  | DB modeling and queries |
| Database   | **Supabase (PostgreSQL)**   | Managed backend         |
| Auth       | **Supabase Auth (JWT)**     | Session management      |
| Storage    | **Supabase Storage**        | File uploads            |
| Content    | **MDX + Contentlayer**      | Roadmap pages           |
| i18n       | **next-intl**               | EN/TR localization      |
| State      | **Zustand + LocalStorage**  | Progress/bookmark sync  |
| Deployment | **Vercel + Supabase**       | Serverless hosting      |

---

## âš™ï¸ 3. CORE PRINCIPLES

* **Clean architecture:** Route â†’ Service â†’ Repository â†’ DB.
* **Functional code style:** No OOP, use pure async functions.
* **Type-safe:** Always use TypeScript interfaces & zod validation.
* **Minimal dependencies:** Avoid unnecessary libraries.
* **Separation of concerns:**

  * UI: `/components`
  * Logic: `/lib/services`
  * Data: `/lib/db`
  * API: `/app/api`
* **Security first:**

  * JWT required for protected routes.
  * RLS policies active in Supabase.
  * Only owner can access own progress/bookmarks.

---

## ğŸ—„ï¸ 4. DATABASE RULES

* ORM: **Prisma**
* DB: **PostgreSQL (Supabase)**
* Naming:

  * Table: `snake_case`
  * Fields: `snake_case`
  * Relations: use foreign key naming (`user_id`)
* Every table has:

  ```prisma
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  ```

### Core Tables

```
users, profiles, phase, topic, resource,
quiz, question, choice, quiz_attempt, quiz_answer,
progress_item, bookmark, badge, user_badge
```

### Relations Example

```prisma
model progress_item {
  id          String   @id @default(uuid())
  user_id     String
  topic_id    String
  status      String   // planned | in_progress | completed
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
  user        users    @relation(fields: [user_id], references: [id])
  topic       topic    @relation(fields: [topic_id], references: [id])
}
```

### DB Access

* Access only via `@/lib/db/prismaClient.ts`
* Never query DB directly inside components or API routes.

---

## ğŸ” 5. AUTHENTICATION

* **Supabase Auth (JWT)** used for all protected endpoints.
* Token is sent via `Authorization: Bearer <jwt>`.
* In API routes:

  ```ts
  import { getUser } from "@/lib/auth/supabaseClient"
  const user = await getUser(req)
  if (!user) return NextResponse.json({ success: false, error: "Unauthorized" }, { status: 401 })
  ```

---

## ğŸ§  6. SERVICE LAYER RULES

* Located at `/apps/web/lib/services/`
* One file per domain (e.g., `quizService.ts`, `progressService.ts`)
* Handles:

  * Validation (with Zod)
  * Authorization (via Supabase Auth)
  * DB operations (via Prisma)
  * Error throwing (`AppError`)
* Example:

  ```ts
  export const ProgressService = {
    async updateProgress(userId: string, topicId: string, status: string) {
      return prisma.progress_item.upsert({
        where: { user_id_topic_id: { user_id: userId, topic_id: topicId } },
        update: { status },
        create: { user_id: userId, topic_id: topicId, status },
      })
    }
  }
  ```

---

## ğŸŒ 7. API ROUTES

* Located at `/apps/web/app/api/*`
* Each endpoint represents one resource.
* File structure:

  ```
  /api/
    â”œâ”€â”€ health/route.ts
    â”œâ”€â”€ progress/route.ts
    â”œâ”€â”€ quiz/route.ts
    â”œâ”€â”€ bookmark/route.ts
    â””â”€â”€ auth/route.ts
  ```
* All responses follow standard JSON format:

  ```json
  {
    "success": true,
    "data": {},
    "error": "optional"
  }
  ```

---

## ğŸ¨ 8. FRONTEND RULES

* Components live in `/components/*`
* Shared UI components â†’ `/packages/ui/`
* Design system â†’ Tailwind + shadcn
* Keep components pure, logic-free.
* Page organization:

  ```
  /app/
    â”œâ”€â”€ roadmap/          â†’ Roadmap list & phases
    â”œâ”€â”€ dashboard/        â†’ User progress & quizzes
    â”œâ”€â”€ resources/        â†’ Learning materials
    â””â”€â”€ api/              â†’ Backend endpoints
  ```
* Local state â†’ Zustand (progress/bookmarks)
* Persist state in LocalStorage, sync with DB after login.

---

## ğŸŒ 9. INTERNATIONALIZATION (i18n)

* Library: **next-intl**
* Directory: `/apps/web/locales/`
* Structure:

  ```
  locales/
  â”œâ”€â”€ en/
  â”‚   â”œâ”€â”€ common.json
  â”‚   â”œâ”€â”€ roadmap.json
  â”‚   â””â”€â”€ quiz.json
  â””â”€â”€ tr/
      â”œâ”€â”€ common.json
      â”œâ”€â”€ roadmap.json
      â””â”€â”€ quiz.json
  ```
* New language â†’ add folder + update `next-intl.config.js`
* MDX content mirrored in `/content/<lang>`

---

## ğŸ“š 10. CONTENT LAYER (MDX)

* All roadmap content stored as `.mdx` under:

  ```
  /apps/web/content/en/
  /apps/web/content/tr/
  ```
* MDX frontmatter:

  ```mdx
  ---
  title: "Phase 1 - Python Foundations"
  difficulty: "Beginner"
  duration: 3
  order: 1
  ---
  ```
* Contentlayer parses metadata and exposes to `/roadmap/[phase]`.

---

## ğŸ§± 11. DEVELOPMENT RULES

* **One new feature = one new service + API route + DB model (if needed).**
* **Never bypass service layer.**
* **Always run lint & format before commit.**
* **Use .env.local for local secrets, never push it.**
* **Deploy pipeline:**

  * Vercel (Next.js)
  * Supabase (DB/Auth/Storage)

---

## ğŸ§ª 12. TESTING & VALIDATION

* Use `zod` for API input validation.
* Example:

  ```ts
  const schema = z.object({
    topicId: z.string().uuid(),
    status: z.enum(["planned", "in_progress", "completed"]),
  })
  ```
* Run `npx prisma validate` before migrations.
* Use Supabase dashboard for RLS testing.

---

## ğŸ§° 13. UTILITIES & CONSTANTS

* `/lib/utils/` â†’ reusable helpers (formatDate, errorHandler)
* `/lib/constants/` â†’ fixed values (API paths, enums)
* `/lib/auth/supabaseClient.ts` â†’ user session helpers
* `/lib/db/prismaClient.ts` â†’ singleton Prisma client

---

## ğŸª¶ 14. CODING STYLE & NAMING

* **Variables:** camelCase
* **Functions:** verb + noun (e.g., `getUserProfile`)
* **Components:** PascalCase
* **Files:** kebab-case
* **Database:** snake_case
* **Services:** `XService.ts` (e.g., `QuizService.ts`)
* **Return types:** always explicit
* **Error class:** `AppError` with `status` and `message`.

---

## ğŸš¦ 15. API RESPONSE STANDARD

| Field   | Type    | Description            |
| ------- | ------- | ---------------------- |
| success | boolean | Operation status       |
| data    | any     | Result payload         |
| error   | string  | Error message (if any) |

Example:

```json
{
  "success": true,
  "data": { "quizId": "123", "score": 90 }
}
```

---

## ğŸ”„ 16. DEPLOYMENT & ENVIRONMENT

* **Frontend + API:** Vercel
* **Database + Auth + Storage:** Supabase
* **Env variables:**

  ```
  NEXT_PUBLIC_SUPABASE_URL=
  NEXT_PUBLIC_SUPABASE_ANON_KEY=
  SUPABASE_SERVICE_ROLE_KEY=
  DATABASE_URL=
  ```
* Use Vercel Dashboard for environment management.

---

## ğŸ§  17. SYSTEM HIERARCHY (How the AI Should Understand)

1. Database schema (`packages/db/schema.prisma`) defines truth.
2. Service layer handles logic, validation, auth.
3. API routes expose public interface.
4. Frontend consumes APIs and renders UI.
5. i18n & MDX manage content.
6. These rules (project-rules.md) override all defaults.

---

âœ… **End of Project Rules**
*(All agents, developers, or MCPs must obey this document.)*

---


---
